<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="content-type" content="text/html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--  stylesheet -->
    <link href="css/style.css" rel="stylesheet" />
    <title>OptimlAnalytics</title>
    <!-- Material CDN -->
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Icons+Sharp"
      rel="stylesheet"
    />
    <script src="http://maps.google.com/maps/api/js?sensor=false" 
          type="text/javascript"></script>
    
  </head>
  <body>
    
    <div class="container">
      <aside>
        <div class="top">
          <div class="logo">
            <img src="./images/logo.png" />
            <h2>Optiml<span class="danger">Analytics</span></h2>
          </div>
          <div class="close" id="close-btn">
            <span class="material-icons-sharp">close</span>
          </div>
        </div>
        <div class="sidebar">
          <a href="#">
            <span class="material-icons-sharp"> grid_view </span>
            <h3>Dashboard</h3>
          </a>
          <a href="#" class="active">
            <span class="material-icons-sharp"> location_on </span>
            <h3>Location</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> store </span>
            <h3>Capacity</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> article </span>
            <h3>Test Demand</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> language </span>
            <h3>Referral Languages</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> local_shipping </span>
            <h3>Transportation</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> settings </span>
            <h3>Settings</h3>
          </a>
          <a href="#">
            <span class="material-icons-sharp"> logout </span>
            <h3>Logout</h3>
          </a>
        </div>
      </aside>
      <!-- End of aside -->
      <main>
        <h1>Dashboard</h1>

        <div class="insights">
          <div class="Utilization">
            <div class="middle">
              <div class="left">
                <h1>Utilization</h1>
                <link><h5>refresh</h5></link>
              </div>
              <div class="progress">
                <svg>
                  <circle cx="38" cy="38" r="36"></circle>
                </svg>
                <div class="number">
                  <p>82%</p>
                </div>
              </div>
            </div>
            <small class="text muted">Learn more</small>
          </div>
          <!-- Utilization END -->
          <div class="Cost">
            <div class="middle">
              <div class="left">
                <h1>Cost</h1>
                
                <h2><span class="material-icons-sharp">
                  currency_rupee
                  </span>22,000 
                  
                </h2>
              </div>
              <div class="progress">
                <svg>
                  <circle cx="38" cy="38" r="36"></circle>
                </svg>
                <div class="number">
                  <p>71%</p>
                </div>
              </div>
            </div>
            <small class="text muted">Learn more</small>
          </div>
          <!-- Cost END -->
          <div class="Referral Distance">
            <div class="middle">
              <div class="left">
                <h1>Referral Distance</h1>
                <link><h2>23 km</h2></link>
              </div>
              <div class="progress">
                <svg>
                  <circle cx="38" cy="38" r="36"></circle>
                </svg>
                <div class="number">
                  <p>49%</p>
                </div>
              </div>
            </div>
            <small class="text muted">Learn more</small>
          </div>
          <!-- Referral distance END -->
          
        </div>
        <!-- INsights end -->
        <div class="container2">
        <div class="recent-orders">
           <h2>Map</h2>
            <div class="mappy" id="map" ></div>
            <script type="text/javascript">
              fetch('http://127.0.0.1:5000/getLocations')
            .then(response => response.json())
            .then(json =>{ var locations = json
              var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: new google.maps.LatLng(-33.92, 151.25),
                mapTypeId: google.maps.MapTypeId.ROADMAP
              });
          
              var infowindow = new google.maps.InfoWindow();
          
              var marker, i;
          
              for (i = 0; i < locations.length; i++) {  
                marker = new google.maps.Marker({
                  position: new google.maps.LatLng(locations[i][1], locations[i][2]),
                  map: map
                });
          
                google.maps.event.addListener(marker, 'click', (function(marker, i) {
                  return function() {
                    infowindow.setContent(locations[i][0]);
                    infowindow.open(map, marker);
                  }
                })(marker, i));
              }
              })
                  //bar
                  var ctxB = document.getElementById("barChart").getContext('2d');
              var myBarChart = new Chart(ctxB, {
                type: 'bar',
                data: {
                  labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
                  datasets: [{
                    label: '# of Votes',
                    data: [12, 19, 3, 5, 2, 3],
                    backgroundColor: [
                      'rgba(255, 99, 132, 0.2)',
                      'rgba(54, 162, 235, 0.2)',
                      'rgba(255, 206, 86, 0.2)',
                      'rgba(75, 192, 192, 0.2)',
                      'rgba(153, 102, 255, 0.2)',
                      'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                      'rgba(255,99,132,1)',
                      'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(75, 192, 192, 1)',
                      'rgba(153, 102, 255, 1)',
                      'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                  }]
                },
                options: {
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero: true
                      }
                    }]
                  }
                }
              });
          
            </script>
            <!-- ------------MAP end -->
            <!-- <div class="ReferralnoDistance">
              <div class="middle">
                <div class="left">
                  <h1>Optimization  </h1>
                  <link><h2>Demand</h2></link>
                </div>
                <div class="progress">
                  <svg>
                    <circle cx="38" cy="38" r="36"></circle>
                    
                  </svg>
                  
                  <div class="number">
                    <p>92%</p>
                    
                  </div>
                  
                </div>
              </div>
              <small class="text muted">Learn more</small>
            </div> -->
        </div>
        <div class="graph2">
          <h2>Graph2</h2>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <div class="lchart" id="linechart_material"></div>
        <script>
          google.charts.load('current', {'packages':['line']});
      google.charts.setOnLoadCallback(drawChart);

    function drawChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('number', 'Day');
      data.addColumn('number', 'Guardians of the Galaxy');
      data.addColumn('number', 'The Avengers');
      data.addColumn('number', 'Transformers: Age of Extinction');

      data.addRows([
        [1,  37.8, 80.8, 41.8],
        [2,  30.9, 69.5, 32.4],
        [3,  25.4,   57, 25.7],
        [4,  11.7, 18.8, 10.5],
        [5,  11.9, 17.6, 10.4],
        [6,   8.8, 13.6,  7.7],
        [7,   7.6, 12.3,  9.6],
        [8,  12.3, 29.2, 10.6],
        [9,  16.9, 42.9, 14.8],
        [10, 12.8, 30.9, 11.6],
        [11,  5.3,  7.9,  4.7],
        [12,  6.6,  8.4,  5.2],
        [13,  4.8,  6.3,  3.6],
        [14,  4.2,  6.2,  3.4]
      ]);

      var options = {
        chart: {
          title: 'Box Office Earnings in First Two Weeks of Opening',
          subtitle: 'in millions of dollars (USD)'
        },
        width: 600,
        height: 300
        
      };

      var chart = new google.charts.Line(document.getElementById('linechart_material'));

      chart.draw(data, google.charts.Line.convertOptions(options));
    }
  </script>

              
        </div>
      </div>
      </main>
      <!-- Main END -->
      <div class="right">
        <div class="top">
          <button id="menu-btn">
            <span class="material-icons-sharp">menu</span>
          </button>
          <div class="profile">
            <div class="info">
              <p>Hey, <b>Sidak</b></p>
              <small class="'text-mued">Admin</small>
            </div>
            <div class="profile-photo">
              <img src="./images/profile-1.jpg">
            </div>
          </div>
             
          </div>
          <!-- end admin -->
          <div class="recent-updates">
            <h2>Import File</h2>
            <div class="updates">
              <script type="text/javascript">
                function Upload() {
                    var fileUpload = document.getElementById("fileUpload");
                    var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/;
                    if (regex.test(fileUpload.value.toLowerCase())) {
                        if (typeof (FileReader) != "undefined") {
                            var reader = new FileReader();
                            reader.onload = function (e) {
                                var table = document.createElement("table");
                                var rows = e.target.result.split("\n");
                                for (var i = 0; i < rows.length; i++) {
                                    var cells = rows[i].split(",");
                                    if (cells.length > 1) {
                                        var row = table.insertRow(-1);
                                        for (var j = 0; j < cells.length; j++) {
                                            var cell = row.insertCell(-1);
                                            cell.innerHTML = cells[j];
                                        }
                                    }
                                }
                                var dvCSV = document.getElementById("dvCSV");
                                dvCSV.innerHTML = "";
                                dvCSV.appendChild(table);
                            }
                            reader.readAsText(fileUpload.files[0]);
                        } else {
                            alert("This browser does not support HTML5.");
                        }
                    } else {
                        alert("Please upload a valid CSV file.");
                    }
                }
            </script>
            <input type="file" class="lol" id="fileUpload" />
            <input type="button" id="upload" value="Upload" class="btn btn-primary" onclick="Upload()" />
            <hr />
            <div id="dvCSV">
            </div>
            </div>
          </div>
          <div class="sales-analytics">
            <h2>Graph</h2>
            
            <div class="item">
              <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
              <div class="chartin" id="chart_div"></div>
              <script>
              google.charts.load('current', {packages: ['corechart', 'bar']});
google.charts.setOnLoadCallback(drawBasic);

function drawBasic() {

      var data = google.visualization.arrayToDataTable([
        ['City', '2010',],
        ['New, NY', 8175000],
        ['Los, CA', 3792000],
        ['Chi, IL', 2695000],
        ['Hou, TX', 2099000],
        ['Phil, PA', 1526000]
      ]);

      var options = {
        title: 'Population of Largest U.S. Cities',
        chartArea: {width: '40%'},
        hAxis: {
          title: 'Total Population',
          minValue: 0
        },
        vAxis: {
          title: 'City'
        }
      };

      var chart = new google.visualization.BarChart(document.getElementById('chart_div'));

      chart.draw(data, options);
    }
    </script>
              
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="./index.js"></script>
  </body>
</html>
